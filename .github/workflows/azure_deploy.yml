name: CI

on:
  push:
    branches:
      - master

jobs:
  deploy:

    runs-on: ubuntu-latest

    steps:
    - name: get files
      uses: actions/checkout@v2
    - name: Login to Azure
      env:
        service_username: ${{ secrets.DEPLOY_SERVICE_USERNAME }}
        service_secret: ${{ secrets.DEPLOY_SERVICE_SECRET }}
      run: az login -u $service_username -p $service_secret
    - name: Set subscription id
      env:
        subscription: ${{ secrets.AZURE_SUBSCRIPTION }}
      run: az account set --subscription $subscription
    - name: Upload site
      env:
        connection_string: ${{ secrets.STORAGE_CONNECTION_STRING }}
      run: az storage blob upload-batch -s ./wwwroot -d \$web --connection-string $connection_string

